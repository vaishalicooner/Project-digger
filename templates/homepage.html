{% extends 'base.html' %}
{% block content %}
<!-- <h1> Welcome to Digger. Your dogs playground! </h1> -->

<p>Welcome to Digger. Your dogs playground!</p>
 
<button><a href="/all_dogs">All Dogs</a></button>
<button><a href="/homepage">Home</a></button>
<button><a href="/activity_log">Activity Log</a></button>
<button><a href="/profile">Profile</a></button>
<button><a href="/logout">Logout</a></button>
<br><br>
<form>
    <button><a href="/add_dog">Add dog</a></button>
</form>

<!--  WEATHER API  -->

<div> 
    <h3><i> Weather </i> </h3>
    <img src = http://openweathermap.org/img/w/01d.png>
    <p><b> Weather: </b>
        {{weather["description"]}}<br>
        <b> Temperature: </b>
        {{weather["temp"]}}F<br>
    </p>
</div>
<a href="https://www.accuweather.com/en/us/sunnyvale-ca/94087/weather-forecast/331979" class="aw-widget-legal">

</a><div id="awcc1539557126424" class="aw-widget-current"  data-locationkey="331979" data-unit="f" data-language="en-us" data-useip="false" data-uid="awcc1539557126424"></div><script type="text/javascript" src="https://oap.accuweather.com/launch.js"></script>
<br>
<br>

<!-- LIST OF PRESENT DOGS IN DOG PARK -->

<table id="mytable" align="right">
    <tbody id="checkedin_dogs">
        <thead>
                <th> List of dogs at present!</th>    
        </thead>
        
    {% for log in logs%}
      <tr>
        <td>{{log.dog.dogname}}</td>
    </tr>
    {%endfor%}
</tbody>
</table>



{% for pic in dog_profiles.dogs%}
<p><img src =  'static/upload/{{pic.pic}}' width="300" height="200"></p>
{% endfor %}

<!--  GETTING DOG PICTURE FROM DATABASE  -->



<!--  GETTING USERS DOGS -->
<form id = "checkin_form" method="POST">
{% for dog in dog_profiles.dogs %}
<input type="checkbox" name="dog" value="{{dog.dog_id}}">{{dog.dogname}}
{% endfor %}
</form><br>

<button id = "checkin" value = "Check-in">Check-in</button>
<button id = "checkout" value = "Check-out">Check-out</button><br><br>

<div id="message"></div>

<script>
  "use strict";
  
    let button1 = $('#checkin');

    function checkin_click(evt) {
        evt.preventDefault();
        
            let form_data = $("#checkin_form").serialize();
            console.log(form_data);
            $.post('/checkin', form_data, function(data) 
            {
                console.log(data)
                $("#mytable tbody").empty();
                let names = "";

               for (let name of data.checkedin_dogs) {
                console.log(name)
                
                let new_row = "<tr><td>" + name + "</td></tr>";
                // $("#checkedin_dogs").append(name);
                $("#checkedin_dogs").append(new_row);
            }

            // for (let name of data.checkedin_dogs){
            //     if ((data.checkedin_dogs).length <= 2){
                        // (name)
            // }

        //     for (let name of data.checkedin_dogs){
        //     $('#message').html(name +'and'+ name + ' checked in at : ' + data.check_in_time);
        // }
        $('#message').html(name + ' checked in at : ' + data.check_in_time);
            // }

        })
    }

    button1.on('click', checkin_click)


    let button2 = $('#checkout');

    function checkout_click(evt) {
        evt.preventDefault();
    
        let form_data = $("#checkin_form").serialize();
        console.log(form_data);
        $.post('/checkout', form_data, function(data)
        {
            console.log(data);
           
        $('#message').html('checked out at : ' + data.check_out_time);
        // $("#checkedin_dogs").remove(new_row);

        })
        
    }

    button2.on('click', checkout_click)

 </script>  

 <!--  CHART FOR DOGS -->


<div class="dog-chart">
    <canvas id="lineChart" width="200" height="150"></canvas>
    <div id="lineLegend" class="chart-legend"></div>
</div>

<script>
    const options = {
      responsive: true
    };

    // Make Line Chart of dogs in a week.
    let ctx_line = $("#lineChart").get(0).getContext("2d");

    $.get("/activity_log", function (data) {
      let myLineChart = Chart.Line(ctx_line, {
                                    type: 'line',
                                    data: data,
                                    options: options
                                });
      $("#lineLegend").html(myLineChart.generateLegend());
    });
</script>

{% endblock %}